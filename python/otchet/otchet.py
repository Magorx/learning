from math import sqrt


L = 0.7
g = 9.8
R = 0.15
m = 0.173
I = m * R * R / 2
h0 = 0.2

def count_T(hi, hj):
    return 2 * 1 / (4 * hi / sqrt ((2 * hi * g) / (1 + I / (m * R * R))))
    #return sqrt((2 * ((hi + hj) * (1 + I / (m * R * R))) / g))


def main(arr):
    hq = []
    h_q = []
    Tq = []
    tq = []
    dtq = []
    for i in range(1, len(arr) - 1):
        h, t = arr[i]
        h_ = 0.66 - h
        t_ = t - arr[i - 1][1]
        T = count_T(h_, 0.66 - arr[i + 1][0])

        dh = 0.015
        eh = dh / h
        dL = dh
        eL = dL / L
        dh_ = dL + dh
        eh_ = dh_ / h_

        eT = sqrt(eh_)
        dT = T * eT
        print("h' = {:.2} +- {:.2} | T = {:.5} +- {:.2} | T_teor = {:.5} +- {:.2}".format(h_, dh_, t_, 0.4, T, dT))
        
        hq.append(h)
        h_q.append(h_)
        Tq.append(T)
        tq.append(t)
        dtq.append(t_)

    h0s.append(hq)
    h_s.append(h_q)
    Ts.append(Tq)
    ts.append(tq)
    dts.append(dtq)
    print('______________________')


expirement1 = [
    [0.20, 0.0],
    [0.31, 18.0],
    [0.38, 34.8],
    [0.43, 50.2],
    [0.47, 64.0],
    [0.51, 77.0],
    [0.53, 88.6],
    [0.54, 101.6],
    [0.57, 111.2],
    [0.58, 122.4],
    [0.60, 131.4],
    [0.61, 140.3],
    [0.62, 149.0],
    [0.63, 156.9],
    [0.63, 166.7],
    [0.64, 173.6],
    [0.65, 181.1],
    [0.65, 187.6],
    [0.66, 194.6],
]

expirement2 = [
    [0.20, 0.0],
    [0.30, 18.8],
    [0.38, 37.7],
    [0.44, 51.0],
    [0.48, 65.3],
    [0.51, 79.2],
    [0.52, 90.4],
    [0.55, 102.5],
    [0.57, 113.2],
    [0.58, 124.0],
    [0.60, 132.7],
    [0.61, 141.9],
    [0.62, 151.6],
    [0.63, 159.6],
    [0.63, 160.3],
    [0.64, 167.6],
    [0.65, 175.5],
    [0.65, 188.2],
    [0.66, 190.2],
]

expirement3 = [
    [0.20, 0.0],
    [0.30, 21.7],
    [0.38, 36.4],
    [0.44, 51.5],
    [0.48, 65.7],
    [0.51, 79.7],
    [0.53, 89.9],
    [0.55, 103.3],
    [0.57, 113.1],
    [0.58, 123.4],
    [0.60, 133.3],
    [0.61, 141.6],
    [0.62, 150.8],
    [0.63, 159.3],
    [0.63, 167.7],
    [0.64, 175.7],
    [0.64, 183.6],
    [0.65, 189.5],
    [0.66, 190.1],
]



h0s = []
Ts = []
ts = []
dts = []
h_s = []
main(expirement1)
main(expirement2)
main(expirement3)